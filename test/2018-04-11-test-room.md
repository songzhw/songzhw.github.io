Room is a persistence library provided by Google. It provides an abstraction layer over SQLite to allow fluent database access. In short, it's like the Hiberate in the server development. This post is most focusing on the testing on Room.

### I. Test Room
Android released [one page to tell us how to test our database](https://developer.android.com/training/data-storage/room/testing-db.html). What it did is quite easy, and it just saving and reading from memory instead of a real database instead.

Here is one test code that is recommended by Android:
```java
@RunWith(AndroidJUnit4.class)
public class SimpleEntityReadWriteTest {
    private UserDao mUserDao;
    private TestDatabase mDb;

    @Before
    public void createDb() {
        Context context = InstrumentationRegistry.getTargetContext();
        mDb = Room.inMemoryDatabaseBuilder(context, TestDatabase.class).build();
        mUserDao = mDb.getUserDao();
    }

    @After
    public void closeDb() throws IOException {
        mDb.close();
    }

    @Test
    public void writeUserAndReadInList() throws Exception {
        User user = TestUtil.createUser(3);
        user.setName("george");
        mUserDao.insert(user);
        List<User> byName = mUserDao.findUsersByName("george");
        assertThat(byName.get(0), equalTo(user));
    }
}
```

### II. Why this is not enough?
But I had to say, this is quite limited. First of all, to use "AndroidJUnit4", you will be asked to provide a device or emulator to run this test. Second, since it involves passing test to device/emulator, it takes more time than just pure JUnit test. 

Okay, I had to admit that this is actually the down side of AndroidJUnit test. And that's also why I recommended Robolectric test. Robolectric requires no device or emulator, and it's pure JUnit test, which makes it very fast. If you have to run the test every day, you will know how much time you saved every single day.

So I tried to replace it with Robolectric test. However, things are not going as well as I expected.  I encoutered a couple of tricky problems. That's  actually this blog for, to tell you how to use Robolectric to test Room, and show you how to avoid the same mistakes I made.

### III.  Error01 : run DB on the main thread


### IV.  Error02: add a thread



### V.




